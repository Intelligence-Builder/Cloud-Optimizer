{
  "issue_number": 31,
  "title": "7.3 Cost Analysis Scanner",
  "body": "# 7.3 Cost Analysis Scanner\n\n## Parent Epic\nEpic 7: MVP Phase 2 - Security & Cost Scanning\n\n## Overview\n\nImplement cost analysis scanning that identifies savings opportunities in AWS accounts. Uses Cost Explorer API, Trusted Advisor, and resource analysis to provide actionable cost optimization recommendations with estimated dollar savings.\n\n## Background\n\nCost optimization is a key value driver for trial customers. The scanner must:\n- Identify unused/underutilized resources\n- Provide rightsizing recommendations\n- Calculate estimated savings in dollars\n- Integrate with chat for cost-related questions\n- Stay within trial limits\n\n## Requirements\n\n| ID | Requirement | Acceptance Criteria |\n|----|-------------|---------------------|\n| CST-001 | Cost Explorer integration | Query last 30 days spend by service, identify trends |\n| CST-002 | Unused resource detection | Identify idle EC2, unattached EBS, unused EIPs |\n| CST-003 | Rightsizing recommendations | EC2 rightsizing based on utilization metrics |\n| CST-004 | Reserved Instance analysis | RI coverage and savings recommendations |\n| CST-005 | Savings estimation | Calculate monthly savings for each recommendation |\n\n## Technical Specification\n\n### Cost Scanner Architecture\n\n```\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        Cost Scanner                                  \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\u2502\n\u2502  \u2502                     Data Sources                                 \u2502\u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\u2502\n\u2502  \u2502  \u2502 Cost Explorer\u2502  \u2502 CloudWatch   \u2502  \u2502 Resource Inventory   \u2502  \u2502\u2502\n\u2502  \u2502  \u2502 - Spend data \u2502  \u2502 - Utilization\u2502  \u2502 - EC2, EBS, EIP      \u2502  \u2502\u2502\n\u2502  \u2502  \u2502 - Trends     \u2502  \u2502 - Metrics    \u2502  \u2502 - Snapshots          \u2502  \u2502\u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\u2502\n\u2502                              \u2502                                       \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u2502\n\u2502  \u2502                    Analyzers                                   \u2502  \u2502\n\u2502  \u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\u2502  \u2502\n\u2502  \u2502  \u2502 Unused      \u2502  \u2502 Rightsizing \u2502  \u2502 Reserved Instance       \u2502\u2502  \u2502\n\u2502  \u2502  \u2502 Resources   \u2502  \u2502 Analysis    \u2502  \u2502 Analysis                \u2502\u2502  \u2502\n\u2502  \u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\u2502  \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518  \u2502\n\u2502                              \u2502                                       \u2502\n\u2502                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u25bc\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                            \u2502\n\u2502                    \u2502 Cost Findings     \u2502                            \u2502\n\u2502                    \u2502 (with $ savings)  \u2502                            \u2502\n\u2502                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                            \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```\n\n### Database Schema\n\n```sql\n-- Cost findings table\nCREATE TABLE cost_findings (\n    finding_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    job_id UUID NOT NULL REFERENCES scan_jobs(job_id),\n    tenant_id UUID NOT NULL REFERENCES tenants(tenant_id),\n    aws_account_id VARCHAR(12) NOT NULL,\n\n    -- Finding details\n    category VARCHAR(50) NOT NULL,       -- 'unused_resource', 'rightsizing', 'reserved_instance'\n    resource_type VARCHAR(50) NOT NULL,  -- 'ec2_instance', 'ebs_volume', etc.\n    resource_id VARCHAR(255) NOT NULL,\n    resource_name VARCHAR(255),\n    region VARCHAR(20) NOT NULL,\n\n    -- Cost analysis\n    current_monthly_cost DECIMAL(10, 2),\n    recommended_monthly_cost DECIMAL(10, 2),\n    estimated_monthly_savings DECIMAL(10, 2),\n    estimated_annual_savings DECIMAL(10, 2),\n    confidence VARCHAR(10),              -- 'high', 'medium', 'low'\n\n    -- Recommendation\n    title VARCHAR(255) NOT NULL,\n    description TEXT NOT NULL,\n    recommendation TEXT NOT NULL,\n    recommendation_type VARCHAR(50),     -- 'terminate', 'resize', 'purchase_ri'\n\n    -- For rightsizing\n    current_instance_type VARCHAR(50),\n    recommended_instance_type VARCHAR(50),\n    utilization_data JSONB,              -- CPU/memory/network metrics\n\n    -- Status\n    status VARCHAR(20) NOT NULL DEFAULT 'open',  -- open, implemented, dismissed\n    implemented_at TIMESTAMPTZ,\n\n    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\n    updated_at TIMESTAMPTZ NOT NULL DEFAULT NOW()\n);\n\nCREATE INDEX idx_cost_findings_job ON cost_findings(job_id);\nCREATE INDEX idx_cost_findings_tenant ON cost_findings(tenant_id);\nCREATE INDEX idx_cost_findings_category ON cost_findings(category);\nCREATE INDEX idx_cost_findings_savings ON cost_findings(estimated_monthly_savings DESC);\n\n-- Cost summary table (per scan)\nCREATE TABLE cost_summaries (\n    summary_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    job_id UUID NOT NULL REFERENCES scan_jobs(job_id),\n    tenant_id UUID NOT NULL REFERENCES tenants(tenant_id),\n    aws_account_id VARCHAR(12) NOT NULL,\n\n    -- Spend summary\n    total_monthly_spend DECIMAL(12, 2),\n    spend_by_service JSONB,              -- {\"EC2\": 1500, \"RDS\": 800, ...}\n    spend_trend_30d DECIMAL(5, 2),       -- % change vs previous 30 days\n\n    -- Savings summary\n    total_potential_monthly_savings DECIMAL(12, 2),\n    savings_by_category JSONB,           -- {\"unused\": 500, \"rightsizing\": 300}\n\n    -- Resource counts\n    total_resources_analyzed INTEGER,\n    resources_with_recommendations INTEGER,\n\n    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW()\n);\n```\n\n### Cost Scanner Service\n\n```python\n# src/cloud_optimizer/scanners/cost/cost_scanner.py\nfrom decimal import Decimal\n\nclass CostScanner:\n    def __init__(self, session: boto3.Session):\n        self.session = session\n        self.ce_client = session.client(\"ce\")\n        self.ec2_client = session.client(\"ec2\")\n        self.cloudwatch = session.client(\"cloudwatch\")\n\n    async def scan(self, regions: list[str]) -> CostScanResult:\n        \"\"\"Run full cost analysis scan.\"\"\"\n        findings = []\n\n        # Get cost data\n        spend_data = await self._get_spend_summary()\n\n        # Run analyzers\n        findings.extend(await self._analyze_unused_resources(regions))\n        findings.extend(await self._analyze_rightsizing(regions))\n        findings.extend(await self._analyze_ri_coverage())\n\n        # Calculate totals\n        total_savings = sum(f.estimated_monthly_savings for f in findings)\n\n        return CostScanResult(\n            findings=findings,\n            spend_summary=spend_data,\n            total_potential_monthly_savings=total_savings,\n        )\n\n    async def _get_spend_summary(self) -> SpendSummary:\n        \"\"\"Get cost summary from Cost Explorer.\"\"\"\n        end_date = datetime.utcnow().date()\n        start_date = end_date - timedelta(days=30)\n\n        response = self.ce_client.get_cost_and_usage(\n            TimePeriod={\n                \"Start\": start_date.isoformat(),\n                \"End\": end_date.isoformat(),\n            },\n            Granularity=\"MONTHLY\",\n            Metrics=[\"UnblendedCost\"],\n            GroupBy=[{\"Type\": \"DIMENSION\", \"Key\": \"SERVICE\"}],\n        )\n\n        spend_by_service = {}\n        total = Decimal(\"0\")\n\n        for result in response.get(\"ResultsByTime\", []):\n            for group in result.get(\"Groups\", []):\n                service = group[\"Keys\"][0]\n                amount = Decimal(group[\"Metrics\"][\"UnblendedCost\"][\"Amount\"])\n                spend_by_service[service] = float(amount)\n                total += amount\n\n        return SpendSummary(\n            total_monthly_spend=float(total),\n            spend_by_service=spend_by_service,\n        )\n\n\nclass UnusedResourceAnalyzer:\n    \"\"\"Detect unused and idle resources.\"\"\"\n\n    async def analyze(\n        self, session: boto3.Session, regions: list[str]\n    ) -> list[CostFinding]:\n        findings = []\n\n        for region in regions:\n            ec2 = session.client(\"ec2\", region_name=region)\n\n            # Unattached EBS volumes\n            findings.extend(await self._check_unattached_volumes(ec2, region))\n\n            # Unused Elastic IPs\n            findings.extend(await self._check_unused_eips(ec2, region))\n\n            # Idle EC2 instances\n            cloudwatch = session.client(\"cloudwatch\", region_name=region)\n            findings.extend(\n                await self._check_idle_instances(ec2, cloudwatch, region)\n            )\n\n        return findings\n\n    async def _check_unattached_volumes(\n        self, ec2, region: str\n    ) -> list[CostFinding]:\n        \"\"\"Find EBS volumes not attached to any instance.\"\"\"\n        response = ec2.describe_volumes(\n            Filters=[{\"Name\": \"status\", \"Values\": [\"available\"]}]\n        )\n\n        findings = []\n        for volume in response.get(\"Volumes\", []):\n            # Estimate cost based on size and type\n            size_gb = volume[\"Size\"]\n            volume_type = volume[\"VolumeType\"]\n            monthly_cost = self._estimate_ebs_cost(size_gb, volume_type)\n\n            findings.append(\n                CostFinding(\n                    category=\"unused_resource\",\n                    resource_type=\"ebs_volume\",\n                    resource_id=volume[\"VolumeId\"],\n                    region=region,\n                    title=\"Unattached EBS Volume\",\n                    description=f\"EBS volume {volume['VolumeId']} is not attached to any instance\",\n                    recommendation=\"Delete the volume if no longer needed, or attach to an instance\",\n                    recommendation_type=\"terminate\",\n                    current_monthly_cost=monthly_cost,\n                    recommended_monthly_cost=Decimal(\"0\"),\n                    estimated_monthly_savings=monthly_cost,\n                    estimated_annual_savings=monthly_cost * 12,\n                    confidence=\"high\",\n                )\n            )\n\n        return findings\n\n    async def _check_idle_instances(\n        self, ec2, cloudwatch, region: str\n    ) -> list[CostFinding]:\n        \"\"\"Find EC2 instances with very low CPU utilization.\"\"\"\n        response = ec2.describe_instances(\n            Filters=[{\"Name\": \"instance-state-name\", \"Values\": [\"running\"]}]\n        )\n\n        findings = []\n        for reservation in response.get(\"Reservations\", []):\n            for instance in reservation.get(\"Instances\", []):\n                instance_id = instance[\"InstanceId\"]\n                instance_type = instance[\"InstanceType\"]\n\n                # Get CPU utilization for last 14 days\n                avg_cpu = await self._get_average_cpu(\n                    cloudwatch, instance_id, days=14\n                )\n\n                if avg_cpu < 5:  # Less than 5% average CPU\n                    monthly_cost = self._estimate_ec2_cost(instance_type)\n\n                    findings.append(\n                        CostFinding(\n                            category=\"unused_resource\",\n                            resource_type=\"ec2_instance\",\n                            resource_id=instance_id,\n                            region=region,\n                            title=\"Idle EC2 Instance\",\n                            description=f\"Instance {instance_id} has average CPU utilization of {avg_cpu:.1f}%\",\n                            recommendation=\"Consider stopping or terminating this instance\",\n                            recommendation_type=\"terminate\",\n                            current_monthly_cost=monthly_cost,\n                            recommended_monthly_cost=Decimal(\"0\"),\n                            estimated_monthly_savings=monthly_cost,\n                            estimated_annual_savings=monthly_cost * 12,\n                            confidence=\"high\",\n                            utilization_data={\"avg_cpu_14d\": avg_cpu},\n                        )\n                    )\n\n        return findings\n\n\nclass RightsizingAnalyzer:\n    \"\"\"Recommend instance type changes based on utilization.\"\"\"\n\n    # Instance type mappings for downsizing\n    DOWNSIZE_MAP = {\n        \"t3.xlarge\": \"t3.large\",\n        \"t3.large\": \"t3.medium\",\n        \"t3.medium\": \"t3.small\",\n        \"m5.xlarge\": \"m5.large\",\n        \"m5.large\": \"t3.large\",\n        # ... more mappings\n    }\n\n    async def analyze(\n        self, session: boto3.Session, regions: list[str]\n    ) -> list[CostFinding]:\n        findings = []\n\n        for region in regions:\n            ec2 = session.client(\"ec2\", region_name=region)\n            cloudwatch = session.client(\"cloudwatch\", region_name=region)\n\n            response = ec2.describe_instances(\n                Filters=[{\"Name\": \"instance-state-name\", \"Values\": [\"running\"]}]\n            )\n\n            for reservation in response.get(\"Reservations\", []):\n                for instance in reservation.get(\"Instances\", []):\n                    finding = await self._analyze_instance(\n                        instance, ec2, cloudwatch, region\n                    )\n                    if finding:\n                        findings.append(finding)\n\n        return findings\n\n    async def _analyze_instance(\n        self, instance: dict, ec2, cloudwatch, region: str\n    ) -> CostFinding | None:\n        \"\"\"Analyze single instance for rightsizing opportunity.\"\"\"\n        instance_id = instance[\"InstanceId\"]\n        instance_type = instance[\"InstanceType\"]\n\n        # Get utilization metrics\n        metrics = await self._get_utilization_metrics(\n            cloudwatch, instance_id, days=14\n        )\n\n        # Check if underutilized\n        if metrics[\"avg_cpu\"] < 40 and instance_type in self.DOWNSIZE_MAP:\n            recommended_type = self.DOWNSIZE_MAP[instance_type]\n\n            current_cost = self._get_instance_cost(instance_type)\n            recommended_cost = self._get_instance_cost(recommended_type)\n            savings = current_cost - recommended_cost\n\n            return CostFinding(\n                category=\"rightsizing\",\n                resource_type=\"ec2_instance\",\n                resource_id=instance_id,\n                region=region,\n                title=\"EC2 Rightsizing Opportunity\",\n                description=f\"Instance {instance_id} ({instance_type}) is underutilized with {metrics['avg_cpu']:.1f}% average CPU\",\n                recommendation=f\"Resize from {instance_type} to {recommended_type}\",\n                recommendation_type=\"resize\",\n                current_instance_type=instance_type,\n                recommended_instance_type=recommended_type,\n                current_monthly_cost=current_cost,\n                recommended_monthly_cost=recommended_cost,\n                estimated_monthly_savings=savings,\n                estimated_annual_savings=savings * 12,\n                confidence=\"medium\" if metrics[\"avg_cpu\"] < 20 else \"low\",\n                utilization_data=metrics,\n            )\n\n        return None\n```\n\n## API Endpoints\n\n```\nPOST /api/v1/cost/scan               # Start cost analysis scan\nGET  /api/v1/cost/summary            # Get cost summary for account\nGET  /api/v1/cost/findings           # List cost findings\nGET  /api/v1/cost/findings/:id       # Get finding details\nPUT  /api/v1/cost/findings/:id       # Update finding status (implemented/dismissed)\nGET  /api/v1/cost/savings            # Get total savings potential\n```\n\n## Files to Create\n\n```\nsrc/cloud_optimizer/scanners/cost/\n\u251c\u2500\u2500 __init__.py\n\u251c\u2500\u2500 cost_scanner.py              # Main cost scanner\n\u251c\u2500\u2500 spend_analyzer.py            # Cost Explorer integration\n\u251c\u2500\u2500 unused_analyzer.py           # Unused resource detection\n\u251c\u2500\u2500 rightsizing_analyzer.py      # Rightsizing recommendations\n\u251c\u2500\u2500 ri_analyzer.py               # Reserved Instance analysis\n\u2514\u2500\u2500 pricing.py                   # AWS pricing data\n\nsrc/cloud_optimizer/models/\n\u251c\u2500\u2500 cost_finding.py              # CostFinding model\n\u2514\u2500\u2500 cost_summary.py              # CostSummary model\n\nsrc/cloud_optimizer/api/routers/\n\u2514\u2500\u2500 cost.py                      # Cost API endpoints\n\nalembic/versions/\n\u2514\u2500\u2500 xxx_create_cost_tables.py    # Migration\n\ndata/pricing/\n\u2514\u2500\u2500 ec2_pricing.json             # Cached pricing data\n\ntests/scanners/cost/\n\u251c\u2500\u2500 test_cost_scanner.py\n\u251c\u2500\u2500 test_unused_analyzer.py\n\u251c\u2500\u2500 test_rightsizing_analyzer.py\n\u2514\u2500\u2500 test_ri_analyzer.py\n```\n\n## Testing Requirements\n\n### Unit Tests\n- [ ] `test_spend_analyzer.py` - Cost Explorer parsing\n- [ ] `test_unused_volumes.py` - Unattached EBS detection\n- [ ] `test_unused_eips.py` - Unused EIP detection\n- [ ] `test_idle_instances.py` - Low CPU instance detection\n- [ ] `test_rightsizing.py` - Rightsizing recommendation logic\n- [ ] `test_savings_calculation.py` - Dollar amount calculations\n\n### Integration Tests\n- [ ] `test_cost_scan_integration.py` - Full scan with LocalStack\n\n### Mocking Strategy\n\n```python\n@pytest.fixture\ndef mock_cost_explorer():\n    return {\n        \"ResultsByTime\": [\n            {\n                \"TimePeriod\": {\"Start\": \"2024-01-01\", \"End\": \"2024-01-31\"},\n                \"Groups\": [\n                    {\"Keys\": [\"Amazon EC2\"], \"Metrics\": {\"UnblendedCost\": {\"Amount\": \"1500.00\"}}},\n                    {\"Keys\": [\"Amazon RDS\"], \"Metrics\": {\"UnblendedCost\": {\"Amount\": \"800.00\"}}},\n                ],\n            }\n        ]\n    }\n```\n\n## Acceptance Criteria Checklist\n\n- [ ] Cost Explorer data retrieved for last 30 days\n- [ ] Spend by service calculated correctly\n- [ ] Unattached EBS volumes detected\n- [ ] Unused Elastic IPs detected\n- [ ] Idle instances (CPU < 5%) detected\n- [ ] Rightsizing recommendations generated for underutilized instances\n- [ ] Savings calculated in dollars (monthly and annual)\n- [ ] Confidence level assigned to each recommendation\n- [ ] Findings queryable via API\n- [ ] Findings status can be updated (implemented/dismissed)\n- [ ] 80%+ test coverage\n\n## Dependencies\n\n- 7.1 AWS Account Connection (needs AWS session)\n\n## Blocked By\n\n- 7.1 AWS Account Connection\n\n## Blocks\n\n- 7.4 Findings Management (generates findings)\n- 8.3 Security Analysis (IB processes cost findings)\n\n## Estimated Effort\n\n1.5 weeks\n\n## Labels\n\n`cost`, `optimization`, `scanner`, `mvp`, `phase-2`, `P0`\n",
  "labels": [
    "mvp",
    "phase-2",
    "P0",
    "cost",
    "optimization",
    "scanner"
  ],
  "assignees": [],
  "milestone": null,
  "created_at": null,
  "updated_at": null,
  "state": "OPEN",
  "context": {
    "complexity": "medium",
    "effort": "medium",
    "confidence": 0.8,
    "required_expertise": [
      "backend",
      "database"
    ],
    "dependencies": [],
    "related_files": []
  },
  "generated_at": "2025-12-04T12:00:25.744090Z",
  "generated_by": "smart-scaffold-cli",
  "branch_name": "feature/issue-31-73costanalysisscanner"
}