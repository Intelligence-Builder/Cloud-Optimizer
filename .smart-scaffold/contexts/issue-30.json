{
  "issue_number": 30,
  "title": "7.2 Security Scanner Engine",
  "body": "# 7.2 Security Scanner Engine\n\n## Parent Epic\nEpic 7: MVP Phase 2 - Security & Cost Scanning\n\n## Overview\n\nImplement the security scanning engine that analyzes AWS account configurations against security best practices and compliance frameworks. The scanner detects misconfigurations in S3, EC2, RDS, IAM, and other core AWS services.\n\n## Background\n\nThe security scanner is the core value proposition for trial customers. It must:\n- Scan AWS resources efficiently (< 5 minutes for typical account)\n- Detect real misconfigurations that matter\n- Map findings to compliance frameworks (HIPAA, SOC2, etc.)\n- Provide actionable remediation guidance\n- Rate-limit scans based on trial limits\n\n## Requirements\n\n| ID | Requirement | Acceptance Criteria |\n|----|-------------|---------------------|\n| SEC-001 | S3 scanning | Public access, encryption, versioning, logging checks |\n| SEC-002 | EC2 scanning | Security groups, IMDSv2, EBS encryption, public IPs |\n| SEC-003 | RDS scanning | Encryption, public access, backup retention, Multi-AZ |\n| SEC-004 | IAM scanning | Password policy, MFA, unused credentials, key rotation |\n| SEC-005 | Scan orchestration | Parallel scanning, progress tracking, cancellation |\n| SEC-006 | Finding generation | Severity scoring, compliance mapping, remediation steps |\n\n## Technical Specification\n\n### Scanner Architecture\n\n```\n\u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\n\u2502                        Scan Orchestrator                            \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510\u2502\n\u2502  \u2502  ScanJob                                                        \u2502\u2502\n\u2502  \u2502  - job_id, tenant_id, aws_account_id                            \u2502\u2502\n\u2502  \u2502  - status: pending \u2192 running \u2192 completed/failed                 \u2502\u2502\n\u2502  \u2502  - progress: 0-100%                                             \u2502\u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\u2502\n\u2502                              \u2502                                       \u2502\n\u2502         \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                 \u2502\n\u2502         \u25bc                    \u25bc                    \u25bc                 \u2502\n\u2502  \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510     \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510           \u2502\n\u2502  \u2502 S3 Scanner  \u2502     \u2502 EC2 Scanner \u2502     \u2502 RDS Scanner \u2502  ...      \u2502\n\u2502  \u2502 - Buckets   \u2502     \u2502 - Instances \u2502     \u2502 - Instances \u2502           \u2502\n\u2502  \u2502 - Policies  \u2502     \u2502 - Sec Groups\u2502     \u2502 - Clusters  \u2502           \u2502\n\u2502  \u2502 - Logging   \u2502     \u2502 - Volumes   \u2502     \u2502 - Snapshots \u2502           \u2502\n\u2502  \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518     \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518           \u2502\n\u2502         \u2502                    \u2502                    \u2502                 \u2502\n\u2502         \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u253c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                 \u2502\n\u2502                              \u25bc                                       \u2502\n\u2502                    \u250c\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2510                              \u2502\n\u2502                    \u2502 Finding Store    \u2502                              \u2502\n\u2502                    \u2502 (PostgreSQL)     \u2502                              \u2502\n\u2502                    \u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518                              \u2502\n\u2514\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2500\u2518\n```\n\n### Database Schema\n\n```sql\n-- Scan jobs table\nCREATE TABLE scan_jobs (\n    job_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    tenant_id UUID NOT NULL REFERENCES tenants(tenant_id),\n    aws_account_id UUID NOT NULL REFERENCES aws_accounts(account_id),\n    scan_type VARCHAR(20) NOT NULL,  -- 'security', 'cost', 'full'\n    status VARCHAR(20) NOT NULL DEFAULT 'pending',  -- pending, running, completed, failed, cancelled\n    progress INTEGER NOT NULL DEFAULT 0,  -- 0-100\n    started_at TIMESTAMPTZ,\n    completed_at TIMESTAMPTZ,\n    error_message TEXT,\n    stats JSONB,  -- {resources_scanned: 150, findings_count: 12, ...}\n    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW()\n);\n\n-- Security findings table\nCREATE TABLE security_findings (\n    finding_id UUID PRIMARY KEY DEFAULT gen_random_uuid(),\n    job_id UUID NOT NULL REFERENCES scan_jobs(job_id),\n    tenant_id UUID NOT NULL REFERENCES tenants(tenant_id),\n    aws_account_id VARCHAR(12) NOT NULL,\n\n    -- Finding details\n    resource_type VARCHAR(50) NOT NULL,  -- 's3_bucket', 'ec2_instance', etc.\n    resource_id VARCHAR(255) NOT NULL,   -- ARN or ID\n    resource_name VARCHAR(255),          -- Friendly name\n    region VARCHAR(20) NOT NULL,\n\n    -- Classification\n    rule_id VARCHAR(50) NOT NULL,        -- 'S3_001', 'EC2_001', etc.\n    title VARCHAR(255) NOT NULL,\n    description TEXT NOT NULL,\n    severity VARCHAR(10) NOT NULL,       -- 'critical', 'high', 'medium', 'low'\n\n    -- Compliance mapping\n    compliance_frameworks JSONB,          -- ['HIPAA', 'SOC2', 'CIS']\n\n    -- Remediation\n    remediation_steps TEXT[],\n    remediation_code TEXT,               -- Terraform/CloudFormation snippet\n    documentation_url TEXT,\n\n    -- Status\n    status VARCHAR(20) NOT NULL DEFAULT 'open',  -- open, acknowledged, resolved, false_positive\n    resolved_at TIMESTAMPTZ,\n\n    created_at TIMESTAMPTZ NOT NULL DEFAULT NOW(),\n    updated_at TIMESTAMPTZ NOT NULL DEFAULT NOW()\n);\n\nCREATE INDEX idx_findings_job ON security_findings(job_id);\nCREATE INDEX idx_findings_tenant ON security_findings(tenant_id);\nCREATE INDEX idx_findings_severity ON security_findings(severity);\nCREATE INDEX idx_findings_rule ON security_findings(rule_id);\nCREATE INDEX idx_findings_resource ON security_findings(resource_type, resource_id);\n```\n\n### Scanner Base Class\n\n```python\n# src/cloud_optimizer/scanners/base.py\nfrom abc import ABC, abstractmethod\nfrom typing import AsyncIterator\nimport boto3\n\nclass BaseScannerRule:\n    \"\"\"Individual security check.\"\"\"\n    rule_id: str\n    title: str\n    description: str\n    severity: str\n    compliance_frameworks: list[str]\n    remediation_steps: list[str]\n\n    @abstractmethod\n    async def check(self, resource: dict, session: boto3.Session) -> Finding | None:\n        \"\"\"Check resource against rule. Returns Finding if violation found.\"\"\"\n        pass\n\n\nclass BaseScanner(ABC):\n    \"\"\"Base class for service scanners.\"\"\"\n\n    service_name: str\n    rules: list[BaseScannerRule]\n\n    def __init__(self, session: boto3.Session):\n        self.session = session\n\n    @abstractmethod\n    async def list_resources(self, region: str) -> AsyncIterator[dict]:\n        \"\"\"Yield all resources to scan in region.\"\"\"\n        pass\n\n    async def scan(self, regions: list[str]) -> AsyncIterator[Finding]:\n        \"\"\"Scan all resources across regions.\"\"\"\n        for region in regions:\n            async for resource in self.list_resources(region):\n                for rule in self.rules:\n                    finding = await rule.check(resource, self.session)\n                    if finding:\n                        finding.resource_type = self.service_name\n                        finding.region = region\n                        yield finding\n```\n\n### S3 Scanner Implementation\n\n```python\n# src/cloud_optimizer/scanners/s3.py\nclass S3PublicAccessRule(BaseScannerRule):\n    rule_id = \"S3_001\"\n    title = \"S3 Bucket Has Public Access\"\n    description = \"S3 bucket allows public access which could expose sensitive data\"\n    severity = \"critical\"\n    compliance_frameworks = [\"HIPAA\", \"SOC2\", \"PCI-DSS\", \"CIS\"]\n    remediation_steps = [\n        \"Enable 'Block all public access' in bucket settings\",\n        \"Review bucket policy for Principal: '*'\",\n        \"Review bucket ACL for public grants\",\n    ]\n\n    async def check(self, bucket: dict, session: boto3.Session) -> Finding | None:\n        s3 = session.client(\"s3\")\n        bucket_name = bucket[\"Name\"]\n\n        # Check Block Public Access settings\n        try:\n            public_access = s3.get_public_access_block(Bucket=bucket_name)\n            config = public_access[\"PublicAccessBlockConfiguration\"]\n\n            if not all([\n                config.get(\"BlockPublicAcls\", False),\n                config.get(\"IgnorePublicAcls\", False),\n                config.get(\"BlockPublicPolicy\", False),\n                config.get(\"RestrictPublicBuckets\", False),\n            ]):\n                return Finding(\n                    resource_id=f\"arn:aws:s3:::{bucket_name}\",\n                    resource_name=bucket_name,\n                    rule_id=self.rule_id,\n                    title=self.title,\n                    description=f\"Bucket '{bucket_name}' does not have all public access blocks enabled\",\n                    severity=self.severity,\n                    compliance_frameworks=self.compliance_frameworks,\n                    remediation_steps=self.remediation_steps,\n                )\n        except s3.exceptions.NoSuchPublicAccessBlockConfiguration:\n            return Finding(\n                resource_id=f\"arn:aws:s3:::{bucket_name}\",\n                resource_name=bucket_name,\n                rule_id=self.rule_id,\n                title=self.title,\n                description=f\"Bucket '{bucket_name}' has no public access block configuration\",\n                severity=self.severity,\n                compliance_frameworks=self.compliance_frameworks,\n                remediation_steps=self.remediation_steps,\n            )\n\n        return None\n\n\nclass S3EncryptionRule(BaseScannerRule):\n    rule_id = \"S3_002\"\n    title = \"S3 Bucket Not Encrypted\"\n    description = \"S3 bucket does not have default encryption enabled\"\n    severity = \"high\"\n    compliance_frameworks = [\"HIPAA\", \"SOC2\", \"PCI-DSS\"]\n    remediation_steps = [\n        \"Enable default encryption (SSE-S3 or SSE-KMS)\",\n        \"For PHI/PCI data, use SSE-KMS with CMK\",\n    ]\n\n    async def check(self, bucket: dict, session: boto3.Session) -> Finding | None:\n        s3 = session.client(\"s3\")\n        bucket_name = bucket[\"Name\"]\n\n        try:\n            s3.get_bucket_encryption(Bucket=bucket_name)\n            return None  # Encryption configured\n        except s3.exceptions.ClientError as e:\n            if \"ServerSideEncryptionConfigurationNotFoundError\" in str(e):\n                return Finding(\n                    resource_id=f\"arn:aws:s3:::{bucket_name}\",\n                    resource_name=bucket_name,\n                    rule_id=self.rule_id,\n                    title=self.title,\n                    description=f\"Bucket '{bucket_name}' does not have default encryption\",\n                    severity=self.severity,\n                    compliance_frameworks=self.compliance_frameworks,\n                    remediation_steps=self.remediation_steps,\n                )\n            raise\n\n\nclass S3Scanner(BaseScanner):\n    service_name = \"s3_bucket\"\n    rules = [\n        S3PublicAccessRule(),\n        S3EncryptionRule(),\n        S3VersioningRule(),\n        S3LoggingRule(),\n    ]\n\n    async def list_resources(self, region: str) -> AsyncIterator[dict]:\n        # S3 is global, only scan once\n        if region != \"us-east-1\":\n            return\n\n        s3 = self.session.client(\"s3\")\n        response = s3.list_buckets()\n\n        for bucket in response.get(\"Buckets\", []):\n            yield bucket\n```\n\n### Scan Orchestrator\n\n```python\n# src/cloud_optimizer/services/scan_orchestrator.py\nclass ScanOrchestrator:\n    SCANNERS = [\n        S3Scanner,\n        EC2Scanner,\n        RDSScanner,\n        IAMScanner,\n    ]\n\n    REGIONS = [\n        \"us-east-1\", \"us-west-2\", \"eu-west-1\", \"ap-southeast-1\"\n    ]\n\n    def __init__(\n        self,\n        db: AsyncSession,\n        aws_connection_service: AWSConnectionService,\n        trial_service: TrialService,\n    ):\n        self.db = db\n        self.aws_connection_service = aws_connection_service\n        self.trial_service = trial_service\n\n    async def start_scan(\n        self,\n        tenant_id: UUID,\n        aws_account_id: UUID,\n        scan_type: str = \"security\",\n    ) -> ScanJob:\n        \"\"\"Start a new security scan.\"\"\"\n        # Check trial limits\n        check = await self.trial_service.check_limit(tenant_id, \"scans\")\n        if not check.allowed:\n            raise TrialLimitExceededException(\"Scan limit reached\")\n\n        # Get AWS session\n        session = await self.aws_connection_service.get_session(aws_account_id)\n\n        # Create scan job\n        job = ScanJob(\n            tenant_id=tenant_id,\n            aws_account_id=aws_account_id,\n            scan_type=scan_type,\n            status=\"pending\",\n        )\n        self.db.add(job)\n        await self.db.commit()\n\n        # Start background scan\n        asyncio.create_task(self._run_scan(job.job_id, session))\n\n        # Record usage\n        await self.trial_service.record_usage(tenant_id, \"scans\")\n\n        return job\n\n    async def _run_scan(self, job_id: UUID, session: boto3.Session):\n        \"\"\"Execute scan in background.\"\"\"\n        job = await self._get_job(job_id)\n\n        try:\n            job.status = \"running\"\n            job.started_at = datetime.utcnow()\n            await self.db.commit()\n\n            total_findings = 0\n            total_resources = 0\n            scanner_count = len(self.SCANNERS)\n\n            for idx, ScannerClass in enumerate(self.SCANNERS):\n                scanner = ScannerClass(session)\n\n                async for finding in scanner.scan(self.REGIONS):\n                    finding.job_id = job_id\n                    finding.tenant_id = job.tenant_id\n                    finding.aws_account_id = job.aws_account_id\n                    self.db.add(finding)\n                    total_findings += 1\n                    total_resources += 1\n\n                # Update progress\n                job.progress = int((idx + 1) / scanner_count * 100)\n                await self.db.commit()\n\n            # Complete job\n            job.status = \"completed\"\n            job.completed_at = datetime.utcnow()\n            job.stats = {\n                \"resources_scanned\": total_resources,\n                \"findings_count\": total_findings,\n            }\n            await self.db.commit()\n\n        except Exception as e:\n            job.status = \"failed\"\n            job.error_message = str(e)\n            job.completed_at = datetime.utcnow()\n            await self.db.commit()\n            raise\n\n    async def get_scan_status(self, job_id: UUID) -> ScanJob:\n        \"\"\"Get current scan status.\"\"\"\n        return await self._get_job(job_id)\n\n    async def cancel_scan(self, job_id: UUID):\n        \"\"\"Cancel a running scan.\"\"\"\n        job = await self._get_job(job_id)\n        if job.status == \"running\":\n            job.status = \"cancelled\"\n            job.completed_at = datetime.utcnow()\n            await self.db.commit()\n```\n\n## Security Rules Coverage\n\n### S3 Rules\n| Rule ID | Title | Severity |\n|---------|-------|----------|\n| S3_001 | Public Access Enabled | Critical |\n| S3_002 | No Default Encryption | High |\n| S3_003 | Versioning Disabled | Medium |\n| S3_004 | Access Logging Disabled | Medium |\n\n### EC2 Rules\n| Rule ID | Title | Severity |\n|---------|-------|----------|\n| EC2_001 | Security Group Allows 0.0.0.0/0 SSH | Critical |\n| EC2_002 | Security Group Allows 0.0.0.0/0 RDP | Critical |\n| EC2_003 | Instance Not Using IMDSv2 | High |\n| EC2_004 | EBS Volume Not Encrypted | High |\n| EC2_005 | Instance Has Public IP | Medium |\n\n### RDS Rules\n| Rule ID | Title | Severity |\n|---------|-------|----------|\n| RDS_001 | Instance Publicly Accessible | Critical |\n| RDS_002 | Storage Not Encrypted | High |\n| RDS_003 | Backup Retention < 7 Days | Medium |\n| RDS_004 | Multi-AZ Not Enabled | Medium |\n\n### IAM Rules\n| Rule ID | Title | Severity |\n|---------|-------|----------|\n| IAM_001 | Root Account Has Access Keys | Critical |\n| IAM_002 | MFA Not Enabled for Users | High |\n| IAM_003 | Access Keys Not Rotated (>90 days) | High |\n| IAM_004 | Password Policy Too Weak | Medium |\n| IAM_005 | Unused Credentials (>90 days) | Medium |\n\n## API Endpoints\n\n```\nPOST /api/v1/scans                   # Start new scan\nGET  /api/v1/scans                   # List scans\nGET  /api/v1/scans/:id               # Get scan status\nPOST /api/v1/scans/:id/cancel        # Cancel running scan\nGET  /api/v1/scans/:id/findings      # Get findings for scan\n```\n\n## Files to Create\n\n```\nsrc/cloud_optimizer/scanners/\n\u251c\u2500\u2500 __init__.py\n\u251c\u2500\u2500 base.py                      # Base scanner classes\n\u251c\u2500\u2500 s3.py                        # S3 scanner\n\u251c\u2500\u2500 ec2.py                       # EC2 scanner\n\u251c\u2500\u2500 rds.py                       # RDS scanner\n\u251c\u2500\u2500 iam.py                       # IAM scanner\n\u2514\u2500\u2500 rules/\n    \u251c\u2500\u2500 __init__.py\n    \u251c\u2500\u2500 s3_rules.py\n    \u251c\u2500\u2500 ec2_rules.py\n    \u251c\u2500\u2500 rds_rules.py\n    \u2514\u2500\u2500 iam_rules.py\n\nsrc/cloud_optimizer/services/\n\u2514\u2500\u2500 scan_orchestrator.py         # Scan orchestration\n\nsrc/cloud_optimizer/models/\n\u251c\u2500\u2500 scan_job.py                  # ScanJob model\n\u2514\u2500\u2500 finding.py                   # Finding model\n\nsrc/cloud_optimizer/api/routers/\n\u2514\u2500\u2500 scans.py                     # Scan API endpoints\n\nalembic/versions/\n\u2514\u2500\u2500 xxx_create_scan_tables.py    # Migration\n\ntests/scanners/\n\u251c\u2500\u2500 test_s3_scanner.py\n\u251c\u2500\u2500 test_ec2_scanner.py\n\u251c\u2500\u2500 test_rds_scanner.py\n\u251c\u2500\u2500 test_iam_scanner.py\n\u2514\u2500\u2500 test_orchestrator.py\n```\n\n## Testing Requirements\n\n### Unit Tests\n- [ ] `test_s3_rules.py` - Each S3 rule individually\n- [ ] `test_ec2_rules.py` - Each EC2 rule individually\n- [ ] `test_rds_rules.py` - Each RDS rule individually\n- [ ] `test_iam_rules.py` - Each IAM rule individually\n- [ ] `test_finding_generation.py` - Finding creation\n\n### Integration Tests\n- [ ] `test_s3_scanner_integration.py` - Full S3 scan (LocalStack)\n- [ ] `test_full_scan.py` - Complete scan orchestration\n\n### LocalStack Setup\n\n```yaml\n# docker-compose.test.yml additions\nlocalstack:\n  image: localstack/localstack:latest\n  environment:\n    - SERVICES=s3,ec2,rds,iam,sts\n    - AWS_DEFAULT_REGION=us-east-1\n  ports:\n    - \"4566:4566\"\n```\n\n## Acceptance Criteria Checklist\n\n- [ ] S3 scanner detects public buckets, missing encryption\n- [ ] EC2 scanner detects open security groups, public IPs\n- [ ] RDS scanner detects public access, missing encryption\n- [ ] IAM scanner detects weak password policy, unused keys\n- [ ] Scan completes in <5 minutes for account with 100 resources\n- [ ] Progress tracking shows 0-100% accurately\n- [ ] Findings include severity, compliance mapping, remediation\n- [ ] Scan cancellation stops processing\n- [ ] Trial limit enforced for scans\n- [ ] All tests pass with LocalStack\n- [ ] 80%+ test coverage\n\n## Dependencies\n\n- 7.1 AWS Account Connection (needs AWS session)\n\n## Blocked By\n\n- 7.1 AWS Account Connection\n\n## Blocks\n\n- 7.4 Findings Management (generates findings)\n- 8.3 Security Analysis (IB processes findings)\n\n## Estimated Effort\n\n2 weeks\n\n## Labels\n\n`scanner`, `security`, `aws`, `mvp`, `phase-2`, `P0`\n",
  "labels": [
    "security",
    "mvp",
    "phase-2",
    "P0",
    "aws",
    "scanner"
  ],
  "assignees": [],
  "milestone": null,
  "created_at": null,
  "updated_at": null,
  "state": "OPEN",
  "context": {
    "complexity": "medium",
    "effort": "medium",
    "confidence": 0.8,
    "required_expertise": [
      "backend",
      "database",
      "security"
    ],
    "dependencies": [],
    "related_files": []
  },
  "generated_at": "2025-12-03T22:26:46.164833Z",
  "generated_by": "smart-scaffold-cli",
  "branch_name": "feature/issue-30-72securityscannerengine"
}